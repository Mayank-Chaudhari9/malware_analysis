BIN=./bin
LOGS=./logs

all: init gpu

# implementation with GPU code
gpu: gpuimpl.cu naiveop trie opcfile gpu_naive logger
	nvcc -arch=sm_20 -g $(BIN)/logger.o $(BIN)/naiveOperations.o $(BIN)/trie.o  $(BIN)/opcodeFile.o $(BIN)/gpu_naive.o gpuimpl.cu -DNUM_FEATURES=300 -o $(BIN)/gpuimpl.o -lm 

run: 
	$(BIN)/gpuimpl.o ../data/opcodelist ../data/benign_2.csv ../data/malicia_2.csv

naiveop: naiveOperations.cu 
	nvcc -g -c -arch=sm_20 naiveOperations.cu -o $(BIN)/naiveOperations.o -lm 

trie: trie.cu  
	nvcc -g -c -arch=sm_20 trie.cu -o $(BIN)/trie.o -lm 

logger: logger.cu logger.h
	nvcc -g -c logger.cu -o $(BIN)/logger.o 

opcfile: opcodeFile.cu 
	nvcc -g -c -arch=sm_20 opcodeFile.cu -o $(BIN)/opcodeFile.o -lm

gpu_naive: gpu_naive.cu
	nvcc -g -c -arch=sm_20 gpu_naive.cu -o $(BIN)/gpu_naive.o -lm 


init:
	mkdir -p $(BIN) $(LOGS)

clean: 
	rm -rf $(BIN) $(LOGS)
