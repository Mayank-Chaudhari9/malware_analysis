\documentclass[conference]{IEEEtran}
\usepackage{float}
\usepackage{comment}
\usepackage{setspace}
\usepackage{blindtext}
\usepackage{graphicx}
%\usepackage{adjustbox}
\usepackage{cite}
\usepackage{hyperref}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{lipsum}

%\hyphenation{op-tical net-works semi-conduc-tor}
\author{
	\IEEEauthorblockN{Author-I}
%	\IEEEauthorblockN{Sanjay K. Sahay}
%	\IEEEauthorblockA{BITS, Pilani\\
%		Department of CS \& IS, \\Goa Campus, India\\
%		ssahay@goa.bits-pilani.ac.in}
	\and
	\IEEEauthorblockN{Author-II}
%	\IEEEauthorblockN{Mayank Chaudhari}
%	\IEEEauthorblockA{BITS, Pilani\\
%		Department of CS \& IS, \\Goa Campus, India\\
%		h20160014@goa.bits-pilani.ac.in}
%	\and
%	\IEEEauthorblockN{Hemant Rathore}
%	\IEEEauthorblockA{BITS, Pilani\\
%		Department of CS \& IS, \\Goa Campus, India\\
%		hemantr@goa.bits-pilani.ac.in}
  }

\begin{document}

%\doublespacing


\title{An Efficient Detection of Malware by Naive Bayes Classifier Using GPGPU}
%
\maketitle
%
%\IEEEtitleabstractindextext{%
\begin{abstract}
 %However, due to continuously increase of huge data, anti-
 %malware industries are facing major challenges to check for the potential malicious
 %content. The reason behind these high volumes of different files is that the malware
 %creators uses obfuscation techniques to generate an entirely new variant of the malware
 %after each infection [3].

 %Despite the advancement in the development of anti-malware the number of
 %malware (Figure 1.3) and cyber-attacks are on an uptrend. An 
 %As per McAfee technical report
 %of 2014, there was more than 200 million known malware samples [10] and the year
 %2013 was the mega breach year [7].

 %The metamorphic malware variants lead to a huge signature database for
 %the detection by traditional signature based techniques.

 %Nowadays most of the computational devices are connected to the internet,
 %as a consequence, these devices are very much vulnerable to the cyber threat/attack
 %from the advanced malware. 

 %But the recent advancement in second gener-
 %ation malware, which can create millions of its variants have posed challenges to the
 %anti-malware developers, and it is an indisputable fact that the traditional approach to
 %combat the threats/attack from today’s highly sophisticated customized second gener-
 %ation malware with a technology-centric are ineffective.


 %The metamorphic malware variants lead to a huge signature database for
 %the detection by traditional signature based techniques. 
 %nearly 8 x 10^8 total malware
 %nearly 6x10^6 malware new https://www.av-test.org/en/statistics/malware/



 %The AV-TEST Institute registers over 250,000 new malicious programs every day. 

Due to continuous increase in the number of malware (according to AV-Test institute total $\sim 8 \times 10^8$ malware are already known, and every day they register $\sim 2.5 \times 10^4$ malware) and files in the 
computational devices, it is very important to design a system which not only effectively but can also efficiently
 detect the new or previously unseen malware to prevent/minimize the damages. Therefore, this paper  presents an approach for the efficient detection of  malware by parallelizing 
the classification using the power of GPGPU and shown that by using the Naive Bayes classifier the detection speed-up can be boosted up to 200x. The investigation also shows that the classification time increases significantly  with the number of features. 

\end{abstract}
%
%% Note that keywords are not normally used for peerreview papers.

\begin{IEEEkeywords}
Malware Detection, GPGPU, Machine Learning, Computer Security.
\end{IEEEkeywords}


%
%
%\IEEEdisplaynontitleabstractindextext
%
%\IEEEpeerreviewmaketitle



% The threat/attack from the advanced/ second generation malware (Chapter 2) are not only limited to individual level, but there are state-sponsored highly skilled hackers developing customized malware to disrupt industries and for military espionage [5].



%most of the computational devices are connected to the internet, as a consequence, these devices are very much vulnerable to the cyber threat from the advanced malware.


\section{Introduction}
\IEEEPARstart The ubiquity of the Internet has engendered the prevalence of information
sharing among networked users and organizations, and in today’s information era, most of the computing devices are connected to the Internet, which has rendered possible countless invasions of privacy/security worldwide from the malware ({\bf mal}icious soft{\bf ware}). In 1970 the first virus was created \cite{Bilar:2007:OPM:1359308.1359312}, and since then malware is continuously evolving with high
complexity to evade the available detection techniques, and new variants of malware
are getting evolve every day, as a consequence, malware defence is becoming a difficult task to protect the computational devices from them. The
use of malware for espionage, sophisticated cyber attacks, and other crimes motivated to develop an advanced method to combat
the threats/attacks from it \cite{Huda_2018} \cite{patent} \cite{DBLP:journals/corr/abs-1802-10135}\cite{Sharma2016AnEA}. However, due to the exponential increase in the number of malware (according to AV-Test institute total $\sim 8 \times 10^8$ malware are already  known, and every day they register $\sim 2.5 \times 10^4$ malware \cite{AV-test}), anti-malware industries not only facing major challenges to check the potential malicious content but to detect the malware efficiently. The reason behind these high volumes of malware is basically in the advancement of second-generation malware which can create millions of its variants by using different obfuscation techniques \cite{ashu1}.  The malware attack/threat are not only limited to individual boundaries, but they are highly skilled state-funded hackers writing customized malicious payloads to disrupt political, industrial working and military espionage \cite{symc17} \cite{stone} \cite{sans1}. The most high-profile, subversive incident was a series of intrusions against the Democratic Party in the US presidential election \cite{symc17}. 



\par In 2017 McAfee has more than 780 million malware samples in their database, and in the 3rd quarter of 2017 there was a 10\% increase in the number of the new malware,  in addition in the same quarter they have observed a 60\% increase in new mobile malware in the Android devices which are mainly due to increase in Android screen locking ransomware \cite{TRMacfee2017}. The Symantec 2017 Internet Security Threat report indicates that there were 357 million new malware variants \cite{symc17}. The recent Internet Security Threat Report \cite{symc18} from Symantec shows an increase of 88\% in overall malware variants. The increase in malware variants is linked to the interest of malware writers in ICS (Industrial Control System), cryptocurrency mining and banking sector. The report states an increase of 92\% in the script and macro down-loaders, 46\% increase in ransomware variants \cite{symc18}. According to the threat report, coin mining was the biggest area in cybercrime with an increase of detection figure up to 8,500\% \cite{symc18}. Hence, if adequate advancement in anti-malware technique is not achieved, consequences at this scale at which new malware are being developed can create fatal effects, and the results will be more severe then past. In this in recent years, various machine learning techniques have been proposed by authors \cite{allix} \cite{canto} \cite{ashu2} \cite{daniele}, which can enhance the capabilities of traditional malware detection system viz. signature matching technique, but with the use of a complex machine learning the detection time increases. Therefore, understanding the exponential increase in the number of malware released every year and files in the 
computational device, it is very important to design a system which not only effectively but can also efficiently detect the new or previously unseen malware to prevent/minimize the damages. Hence in this paper, we  present an efficient static malware analysis approach for the efficient detection of  malware by parallelizing 
the classification using the power of general-purpose graphics processing unit (GPGPU) and shown that by using the Naive Bayes classifier the detection speed-up can be boosted up to 200x. Accordingly, section 2 briefly discusses the related work done in this field. Section 3 describes the data preprocessing and how features are selected for the classification. Section 4  contains the experimental and the result analysis of our approach. Finally, we summarize our conclusion in Section 5.

 


\section{Related Work}

With the evolution of complex second-generation malware which can generate millions of its variant, 
the detection techniques have also been made significant  progress from the early day traditional
 signature matching to deep learning  techniques to improve the detection accuracy \cite{Ye:2018:DHD:3184705.3184734} \cite{DBLP:journals/corr/abs-1801-02950}. In this 
recently Ashu et al. showed that group-wise classification 
of Windows malware in the range of 5 KB, the detection accuracy can be achieved up to 97.95\% \cite{Sharma2016AnEA}. 
Similarly, they have also shown that on an average 97.15\% detection
of Android malware can be achieved by  permission-based group-wise detection system \cite{10.1007/978-981-10-5508-9_20}. However,
understanding the exponential growth of malware and the number of file in our system it is equally
important to focus on the design of an efficient malware detection system. In this 
Ciprian Pungila and Viorel Negru in 2012
 has proposed an efficient memory compression model for virus signature matching using GPGPU \cite{pungila}. They were able to achieve 22 less memory utilization and 38 times higher bandwidth compared to their single-core implementation. In 2014, Che-Lun Hung et al., proposed a GPU based botnet detection technique  \cite{Hung2014ParallelBD}. They implemented the network traffic reduction on GPU and were able to achieve eight times performance over CPU based traffic reduction. For Android devices, Manel Abdellatif et al.  in 2015 has designed and implemented a host-based parallel anti-malware based on mobile GPU  \cite{Manel}. Their implementation was three times faster than the serial implementation on CPU. In 2016, to accelerate the statistical detection of zero-day malware Igor Korkin et al. has proposed a technique using CUDA-enabled GPU Hardware \cite{DBLP:journals/corr/KorkinN16}. In their work, they used GPU mainly for achieving speedup in memory forensic task. Recently, Radu Velea et al. has proposed a CPU/GPU based hybrid approach to accelerate pattern matching of the malware \cite{Velea2017CPUGPUHD}. In their work they found that the hybrid approach takes half of the time compared to the CPU implementation only and consumes 25\% less power.
%\newpage
\section{Data Preprocessing and Feature Selection}


%\subsection{Dataset}

\par For the experimental analysis, we downloaded 11,355 malware from the malicia-project dataset (one of author possess the dataset \cite{ashu2}) and collected 2967 benign programs (also verified from virustotal.com) from different windows operating systems. It has been observed that 97.18\% malware in the malicia dataset is below 500 KB
\cite{Sharma2016AnEA}. Therefore, we took both the samples (i.e., malware and benign programs) which are below 500 KB, and left with 11,305 malware and 2360 benign executables for the analysis. Also, the investigation  by Ashu et al. shows that the variation in the size of the malware generated by malware kits viz. NGVCK, PS-MPC, and G2 do not vary by more than 5 KB range. Therefore, for efficient and effective classification we partitioned the datasets in 100 group each of 5 KB size. 

\par We selected the opcodes of the executable as a feature for the classification of malware because the difference in the opcode occurrence between the malware and benign executable differ in large \cite{Sahay:2016:GED:3066572.3066745}\cite{Sharma2016AnEA}. Therefore the prominent features i.e., opcodes from the data set which can differentiate the malware from benign programs are obtained as given by the Ashu et al. \cite{ashu2}\cite{Sharma2016AnEA} i.e.,  by normalizing the opcodes occurrence difference between the malware and benign executable for all the formed groups independently, and finally top k-features (opcodes) are selected from each group separately for the efficient and effective detection of the malware.

\section{Our Approach and Experimental Analysis}

\par A schematic of the experimental analysis of our approach is shown in the fig. \ref{figure:fc}. For the purpose, we randomly split the dataset (containing only opcode occurrence of every executable) for the training and testing of the malicious and benign dataset separately (a conservative side as per the suggested norms to ensure optimal performance \cite{Guyon-1997}) in the ratio of 2:1 and used Naive Bayes classifier (as the paper focuses on the efficient detection of malware, not on the accuracy, therefore for simplicity we selected the Naive Bayes classifier) which assume strong class independence between different attributes under consideration, i.e., if the given set of  (opcodes in our case), A = $a_1, a_2, a_3,..., a_n$, then the Naive Bayes model computes posterior probability for target class C (malware/benign) and can be represented as \cite{ashu2}.
$$P(C| a_1, a_2, a_3,..., a_n) = \frac{P(a_1, a_2, a_3,..., a_n |C)}{P(a_1, a_2, a_3,..., a_n)}$$

where, $P(C| a_1, a_2, a_3,..., a_n)$ is the posterior probability of an executable sample of belonging to class C. Hence one can calculate the posterior probabilities for the test executable, and if the malware class probability is higher then it is classified as malware otherwise it is labeled as benign.


\begin{figure}[H]
	\centering
	\includegraphics[scale=.22]{FlowChart.png}
	\caption{A schematic of our approach for the efficient detection of malware.}
\label{figure:fc}
\end{figure}

\par The experiment has been conducted in Intel i7-7700HQ quad-core processor with a base frequency of 2.8 GHz, 8 GB RAM, Pascal architecture (GP107) based Nvidia 1050Ti GPU with 768 CUDA cores distributed across 6 SMP and 4GB GPU DRAM operating on a base speed of 1291 MHz. 

\par To improve the detection  efficiency, we trained the model  for all the groups independently with top k-features obtained from each group, except the group which has less than six files either in malware or benign. We find that 
5, 8, 61, 65, 97 98 and 100th group have less then six files in either category (benign or malware). For the actual implementation if any 
group have less than the minimum set number of file, than that group file can be classified/tested with the next group trained model.


\par First we investigated the classification time taken by the CPU by selecting the top 20, 40, 80, 100, 160 and 200 features (figs. \ref{figure:cpu} and \ref{figure:gpu}) from each group and the number of file in multiple of 768 (i.e., number of cores in the GPU), and the results obtained are shown in fig. \ref{figure:cpu}. Next, we find the time taken by GPU after distributing our trained model among all the 768 cores such that trained model of the particular group, the corresponding test file, and top k-features shall be
in same core so that parallelization of the tasks in GPU  can be optimally used. Then we observed the time taken by the GPU by giving the file in the multiple of 768 for the testing/classification and the results obtained are shown in fig. \ref{figure:gpu}.

\begin{figure}[H]
	\centering
	\includegraphics[scale=.53]{CPU_time.png}
	\caption{Time taken by the CPU to classify the file in the multiple of 768 files by varying the number features.}
\label{figure:cpu}
\end{figure}

\par We find that the classification/testing time is also dependent on the number of features, and with the increase in the number of files in the multiple of number cores of GPU, the CPU proportionally take more time than GPU ( figs. \ref{figure:cpu} and \ref{figure:gpu}.
We experimented with various sets of features in the multiple of 20 features and found that the detection accuracy improves by increasing the number of features till top 200 features, after that there is no significant change in accuracy, and remains around $\sim$87\%. Therefore, we  investigated the speed-up with top 200 features (speed-up can be written as, Sp = Tc/Tp, where Tc is the time taken to execute the sequential program and Tp is the time taken to execute the program in parallel, i.e., in GPU with P number of computers/nodes/cores  \cite{parallel_computing} ) and almost all the dataset (as our focus is on the efficiency not on the effectiveness of the classification) for the improvement
in the performance due the parallelization of the task using GPU that can be achieved from the given system, and the obtained result is shown in fig. \ref{figure:su}. We observed that the parallel implementation for the classification of malware using GPU by Naive Bayes algorithm was able to achieve speed-up up to 200 (not taking in account of the overhead involved in the processes).



\begin{figure}[H]
	\centering
\includegraphics[scale=.53]{GPU_time.png}
%	\includegraphics[scale=.5]{graphs/new/timing_log.png}
	\caption{Time taken by the GPU to classify the file in the multiple of 768 files by varying the number features. }
\label{figure:gpu}
	\end{figure}
	
	
\begin{figure}[H]
	\centering
\includegraphics[scale=.53]{speedup.png}
%	\includegraphics[scale=.5]{graphs/new/timing_log.png}
	\caption{Classification speed-up due to parallelization of the task using the GPU.}
\label{figure:su}
	\end{figure}

\section{Conclusion}
We present an approach for the efficient detection of new or previously unseen malware by parallelizing the classification using the power of GPGPU and shown that by using the Naive Bayes classifier the classification speed-up can be boosted up to 200x (not taking in account of the overhead involved in the processes).  However, one has to study the performance using the classical  Random Forest classifier and Deep Learning methods for the efficient and high accuracy classification. Also, the trade-off between the efficiency and accuracy has to be investigated in-depth, i.e., optimal features selection (as classification time significantly increases with the number of features) to train the model after appropriately grouping the input data  for the detection of malware, and in this direction work is in progress and will be be published elsewhere.

\ifCLASSOPTIONcaptionsoff
  \newpage
\fi

\bibliographystyle{ieeetr}
\bibliography{references}{}

\end{document}


